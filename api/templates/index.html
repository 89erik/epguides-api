<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="A layout example that shows off a blog page with a list of posts.">

    <title>{{base_url}}</title>

<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">

<!--[if lte IE 8]>
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-old-ie-min.css">
<![endif]-->
<!--[if gt IE 8]><!-->
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-min.css">
<!--<![endif]-->

    <!--[if lte IE 8]>
        <link rel="stylesheet" href="/static/css/layouts/blog-old-ie.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="/static/css/layouts/blog.css">
    <!--<![endif]-->

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.7/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.7/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.5/marked.min.js"></script>

</head>
<body>

<div id="content"></div>

<script type="text/babel">

var ApiExample = React.createClass({

  getInitialState: function() {
     return {result: "loading ... ", limit:null};
  },

  componentDidMount: function() {
     this.queryEndpoint();
  },

  queryEndpoint: function() {
    let that = this;
    let url = this.props.endpoint.path+"?ignore_tracking";
    $.ajax({ url:url}).success(function(res){
        if(this.props.endpoint.limit) {
          res = res.slice(0, that.props.endpoint.limit);
        }
        this.setState({result:JSON.stringify(res,null,' ')});
     }.bind(this));
  },

  render: function() {

    var results_comment = "";
    if(this.props.endpoint.limit) {
      results_comment = "Note: Number of results are limited to "
      + this.props.endpoint.limit + " in this example";
    }

    return (
      <section className="post">
        <header className="post-header">
            <h3 className="post-title">{this.props.endpoint.title}</h3>
        </header>
        <div className="post-description"> Â 
          <pre>
            <code className="bash hljs">
              <span className="hljs-meta">
                $ curl <a target="_blank" href={this.props.endpoint.path}>{this.props.endpoint.path}</a>
              </span>
            </code>
          </pre>
          <pre>
            <code className="json hljs">
              {this.state.result}
            </code>
          </pre>
          {results_comment}
        </div>
      </section>
    );
  }
});

var ApiRenderOverview = React.createClass({

  render: function() {
    var endpoints = [
      {
        'title': 'All tv shows',
        'path': '{{base_url}}show/',
        'limit': 3,
      },
      {
        'title': 'Next episode of show',
        'path': '{{base_url}}show/bigbangtheory/next/'
      },
      {
        'title': 'Last episode of show',
        'path': '{{base_url}}show/bigbangtheory/last/'
      },
      {
        'title': 'First episode of show',
        'path': '{{base_url}}show/bigbangtheory/first/'
      },
      {
        'title': 'Lookup specific episode',
        'path': '{{base_url}}show/bigbangtheory/1/15/'
      },
      {
        'title': 'Meta data for show',
        'path': '{{base_url}}show/bigbangtheory/info/'
      },
      {
        'title': 'Check if specific episode is released',
        'path': '{{base_url}}show/bigbangtheory/1/5/released/'
      },
      {
        'title': 'Lookup next episode from given episode',
        'path': '{{base_url}}show/bigbangtheory/1/15/next/'
      },
      {
        'title': 'Lookup next episode from given episode (new season)',
        'path': '{{base_url}}show/bigbangtheory/1/17/next/'
      },
      {
        'title': 'Check if next episode from given episode is released',
        'path': '{{base_url}}show/bigbangtheory/1/17/next/released/'
      },
      {
        'title': 'Lookup poster url for show',
        'path': '{{base_url}}show/gameofthrones/poster/'
      },
    ];

    return (
      <div id="layout" className="pure-g">
          <div className="sidebar pure-u-1 pure-u-md-1-4">
              <div className="header">
                  <h1 className="brand-title">epguides api</h1>
                  <h2 className="brand-tagline">TVshows data for everyone</h2>
              </div>
          </div>
          <div className="content pure-u-1 pure-u-md-3-4">
            <div className="posts" id="posts">
              {endpoints.map(function (item) {
                return <ApiExample key={item.path} endpoint={item} />;
              })}
            </div>
          </div>
      </div>
    );
  }
});

ReactDOM.render(
  <ApiRenderOverview />,
  document.getElementById('content')
);

hljs.initHighlightingOnLoad();

</script>

{{fb_pixel|safe}}
{{ga_pixel|safe}}

</body>
</html>
